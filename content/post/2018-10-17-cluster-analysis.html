---
title: "Clustering: cereals, supermarket shelves, and sugar"
author: Ángela Castillo-Gill
date: '2018-10-17'
slug: cluster-analysis-cereals
categories: []
tags: 
  - Cluster analysis
  - Hierarchical clustering
description: "I do perform two types of clustering on the Kaggle cereals dataset."
banner: "banners/cluster.png"
images: ["banners/cluster.png"]
draft: FALSE
header: 
  image: "banners/cluster.png"
  caption: ""
output:
  blogdown::html_page:
    toc: true
    number_sections: true
    toc_depth: 2
  fig_caption: true
editor_options: 
  chunk_output_type: console
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>

<div id="TOC">
<ul>
<li><a href="#summary"><span class="toc-section-number">1</span> Summary</a></li>
<li><a href="#question"><span class="toc-section-number">2</span> Question</a></li>
<li><a href="#dataset-description"><span class="toc-section-number">3</span> Dataset description</a></li>
<li><a href="#hierarchical-clustering"><span class="toc-section-number">4</span> Hierarchical clustering</a></li>
<li><a href="#results"><span class="toc-section-number">5</span> Results</a></li>
<li><a href="#conclusion"><span class="toc-section-number">6</span> Conclusion</a></li>
</ul>
</div>

<div id="summary" class="section level1">
<h1><span class="header-section-number">1</span> Summary</h1>
<p><em>To see the all the code used in this post, visit my <a href="https://github.com/acastillogill/acastillogill">GitHub repository for this site</a></em></p>
<ul>
<li>Objectives: To find what what kind of clusters are there in the <a href="https://www.kaggle.com/crawford/80-cereals/home">cereals dataset</a> available on Kaggle.</li>
<li>Challenge: To implement a clustering algorithm for the first time.</li>
<li>Data points: 1232</li>
<li>Language: R</li>
</ul>
</div>
<div id="question" class="section level1">
<h1><span class="header-section-number">2</span> Question</h1>
<p><strong>What types of clusters are there in the cereals dataset?</strong></p>
</div>
<div id="dataset-description" class="section level1">
<h1><span class="header-section-number">3</span> Dataset description</h1>
<p>The dataset is available on Kaggle. It contains nutrition data on 80 cereal products. I chose this dataset because it had plenty of numeric variables and I’m interested in using two types of clustering algorithms to explore the data. Another reason I chose this dataset is because the data is unlabelled so I can add labels with clustering.</p>
<p>I wanted to focus on numeric variables using Euclidean distances. Not all variables in the dataset were numeric: the cereal name, the manufacturer, the type of cereal (hot or cold). There was also a numeric variable <code>Shelf</code> corresponding to the supemarket display shelf that doesn’t make much sense as a numeric variable, so I removed it from the analysis. After leaving just numeric variables, I was left with 12 variables.</p>
<p>I first scaled the data because I will calculate the Euclidean distance between each cereal but the variables are on different scales. When the data are scaled, the mean for each variable will be zero and a standard deviation of one.</p>
</div>
<div id="hierarchical-clustering" class="section level1">
<h1><span class="header-section-number">4</span> Hierarchical clustering</h1>
<p>I first implemented hierarchical clustering with three different linkage methods. Generally, the hierarchical clustering algorithm works by first linking the two observations that are closest together. It then chooses the closest observation based on <strong>a distance</strong> between the current observation and its distance to each element in a pair. That distance may vary according to the type of linkage as I show in the next tree diagrams (or dendrograms).</p>
<div class="figure"><span id="fig:plot-complete-linkage"></span>
<img src="/post/2018-10-17-cluster-analysis_files/figure-html/plot-complete-linkage-1.png" alt="This tree diagram shows the complete linkage process. Here the algorithm chooses the closest MAXIMUM distance between the considered observation and the current pair. The height in the plot shows the distance between two observation. Each horizontal line represents the number of clusters. After choosing two clusters, we can say that maximum distance between observations in the two clusters is equal two or less than 11.06." width="1344" />
<p class="caption">
Figure 4.1: This tree diagram shows the complete linkage process. Here the algorithm chooses the closest MAXIMUM distance between the considered observation and the current pair. The height in the plot shows the distance between two observation. Each horizontal line represents the number of clusters. After choosing two clusters, we can say that maximum distance between observations in the two clusters is equal two or less than 11.06.
</p>
</div>
<div class="figure"><span id="fig:plot-average-linkage"></span>
<img src="/post/2018-10-17-cluster-analysis_files/figure-html/plot-average-linkage-1.png" alt="This is the average linkage with maximum height 7.57. Here the algorithm chooses the closest AVERAGE distance between the considered observation and the current pair. Although the maximum distance between obsverations in a cluster is shorter than in complete linkage, average linkage leads to one cluster with three observations and another with 74. This an unbalanced set of clusters." width="1344" />
<p class="caption">
Figure 4.2: This is the average linkage with maximum height 7.57. Here the algorithm chooses the closest AVERAGE distance between the considered observation and the current pair. Although the maximum distance between obsverations in a cluster is shorter than in complete linkage, average linkage leads to one cluster with three observations and another with 74. This an unbalanced set of clusters.
</p>
</div>
<div class="figure"><span id="fig:plot-single-linkage"></span>
<img src="/post/2018-10-17-cluster-analysis_files/figure-html/plot-single-linkage-1.png" alt="Single linkage has even a smaller distance between observations with the maximum being 4.16. Here the algorithm chooses the closest MINIMUM distance between the considered observation and the current pair. Here 76 observations are in one cluster and one is in another. " width="1344" />
<p class="caption">
Figure 4.3: Single linkage has even a smaller distance between observations with the maximum being 4.16. Here the algorithm chooses the closest MINIMUM distance between the considered observation and the current pair. Here 76 observations are in one cluster and one is in another.
</p>
</div>
<p>I wanted balanced clusters so I ended up choosing the complete linkage method that classified observations more or less into two similar groups with one cluster having 30 observations and the other 47. Now I’d like to show the differences amongst clusters for each numerical variable.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:mean-for-each-cluster">Table 4.1: </span>Cluster two (47 cereals), has on average, 19% more calories, 30% less protein, 99% more sodium, 62% less fiber, twice as much sugar, 41% less potasium, 89% more vitamins, and 36% lower ratings.
</caption>
<thead>
<tr>
<th style="text-align:right;">
cluster
</th>
<th style="text-align:right;">
calories
</th>
<th style="text-align:right;">
protein
</th>
<th style="text-align:right;">
fat
</th>
<th style="text-align:right;">
sodium
</th>
<th style="text-align:right;">
fiber
</th>
<th style="text-align:right;">
carbo
</th>
<th style="text-align:right;">
sugars
</th>
<th style="text-align:right;">
potass
</th>
<th style="text-align:right;">
vitamins
</th>
<th style="text-align:right;">
rating
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
95.67
</td>
<td style="text-align:right;">
3.100
</td>
<td style="text-align:right;">
1.1000
</td>
<td style="text-align:right;">
99.5
</td>
<td style="text-align:right;">
3.44
</td>
<td style="text-align:right;">
13.42
</td>
<td style="text-align:right;">
4.20
</td>
<td style="text-align:right;">
128.13
</td>
<td style="text-align:right;">
18.33
</td>
<td style="text-align:right;">
54.65
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
114.04
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
0.9574
</td>
<td style="text-align:right;">
198.1
</td>
<td style="text-align:right;">
1.33
</td>
<td style="text-align:right;">
15.35
</td>
<td style="text-align:right;">
8.66
</td>
<td style="text-align:right;">
75.62
</td>
<td style="text-align:right;">
34.57
</td>
<td style="text-align:right;">
35.02
</td>
<td style="text-align:right;">
47
</td>
</tr>
</tbody>
</table>
<p>Since one of the aims of clustering is to label unlabelled data, based on the average differences between the two clusters, I will label cluster one as <code>healthy</code> and cluster two as <code>unhealthy</code>. It’s interesting to see that <code>unhealthy</code> cereals have a worse nutritional profile that <code>healthy</code> cereals but they have 90% more vitamins.</p>
<p>Let’s look at the clusters and see which specific cereals belong to each cluster.</p>
<div class="figure"><span id="fig:plot-sodium-sugar"></span>
<img src="/post/2018-10-17-cluster-analysis_files/figure-html/plot-sodium-sugar-1.png" alt="It's interesting to note how cereal names don't necessarily indicate to which cluster the cereal belongs to. For example, Total Raisin Bran has a high sugar and sodium content, higher than a perhaps intuitively unhealthy cereal like Lucky Charms. Another example is the word Bran, which years of marketing leads us to associate it with healthy cereals. Not always some Bran cereals like 100% Natural Bran, Bran Chex, Raisin Nut Bran do have a relatively low sugar and sodium content. Other Bran products like Raisin Bran, Fruitful Bran, and Post Nat Raisin Bran have a higher sugar content than Fruity Pebbles!" width="1344" />
<p class="caption">
Figure 4.4: It’s interesting to note how cereal names don’t necessarily indicate to which cluster the cereal belongs to. For example, Total Raisin Bran has a high sugar and sodium content, higher than a perhaps intuitively unhealthy cereal like Lucky Charms. Another example is the word Bran, which years of marketing leads us to associate it with healthy cereals. Not always some Bran cereals like 100% Natural Bran, Bran Chex, Raisin Nut Bran do have a relatively low sugar and sodium content. Other Bran products like Raisin Bran, Fruitful Bran, and Post Nat Raisin Bran have a higher sugar content than Fruity Pebbles!
</p>
</div>
<p>From my brief food marketing experience, I remember learning that Brands pay a premium to have their product on certain shelves. I’m curious to know what types of cereals are placed on which shelves.</p>
<div class="figure"><span id="fig:plot-sugar-shelf"></span>
<img src="/post/2018-10-17-cluster-analysis_files/figure-html/plot-sugar-shelf-1.png" alt="The top shelf (3), has an equal quantity of cereals belonging to either cluster. My guess is that brands don't pay extra for their cereals to be stocked on this shelf. The bottom shelf (1) has six more unhealthy cereals. I notice that cereals on this shelf are sort of basics whether they're unhealthy or not: basic Oatmeal, Frosted Flakes, Rice Krispies, Corn Flakes. The middle shelf appears to be the premium one with three times more unhealthy than healthy cereals. For the most part they are the unhealthy ones geared towards children: Cap'n Crunch, Lucky Charms, Fruity Pebbles, Cocoa Puffs." width="1344" />
<p class="caption">
Figure 4.5: The top shelf (3), has an equal quantity of cereals belonging to either cluster. My guess is that brands don’t pay extra for their cereals to be stocked on this shelf. The bottom shelf (1) has six more unhealthy cereals. I notice that cereals on this shelf are sort of basics whether they’re unhealthy or not: basic Oatmeal, Frosted Flakes, Rice Krispies, Corn Flakes. The middle shelf appears to be the premium one with three times more unhealthy than healthy cereals. For the most part they are the unhealthy ones geared towards children: Cap’n Crunch, Lucky Charms, Fruity Pebbles, Cocoa Puffs.
</p>
</div>
</div>
<div id="results" class="section level1">
<h1><span class="header-section-number">5</span> Results</h1>
</div>
<div id="conclusion" class="section level1">
<h1><span class="header-section-number">6</span> Conclusion</h1>
</div>
