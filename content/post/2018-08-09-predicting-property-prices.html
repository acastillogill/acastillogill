---
title: Predicting property prices
author: Ángela Castillo-Gill
date: '2018-08-09'
slug: predicting-property-prices
categories:
  - R
  - EDA
tags: 
  - Kaggle
  - Home sales prices
draft: FALSE
summary: What factors most affect sales prices for homes?
output:
  blogdown::html_page:
    toc: true
    number_sections: true
    toc_depth: 2
  fig_caption: true
editor_options: 
  chunk_output_type: console
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>

<div id="TOC">
<ul>
<li><a href="#summary"><span class="toc-section-number">1</span> Summary</a></li>
<li><a href="#purpose-of-this-post"><span class="toc-section-number">2</span> Purpose of this post</a></li>
<li><a href="#the-data"><span class="toc-section-number">3</span> The data</a></li>
<li><a href="#data-exploration"><span class="toc-section-number">4</span> Data exploration</a></li>
<li><a href="#techniques-used"><span class="toc-section-number">5</span> Techniques used</a></li>
<li><a href="#questions-from-this-analysis"><span class="toc-section-number">6</span> Questions from this analysis</a></li>
</ul>
</div>

<div id="summary" class="section level1">
<h1><span class="header-section-number">1</span> Summary</h1>
<p><em>To see the code used in this post, visit my <a href="https://www.kaggle.com/adcastillogill/exploring-kiva-loans">kernel on kaggle in R Markdown format</a>.</em></p>
</div>
<div id="purpose-of-this-post" class="section level1">
<h1><span class="header-section-number">2</span> Purpose of this post</h1>
</div>
<div id="the-data" class="section level1">
<h1><span class="header-section-number">3</span> The data</h1>
<p>The dataset <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">House Prices: Advanced Regression Techniques</a> was downloaded from Kaggle and put together by <a href="https://ww2.amstat.org/publications/jse/v19n3/decock.pdf">Dean De Cock.</a> It has 79 explanatory variables describing 1,460 homes in Ames, Iowa. The codebook for all the variables can be <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data">found here.</a> As I go along, I’ll explain the most releveant ones.</p>
<p>First we will see how many numerical vs. categorical variables there are.</p>
<p>Our dataset has 38 numeric and 43 character variables. Next, since we are interested in estimating sales prices <code>SalePrice</code>, we will recode character variables and see the most strongly correlated variables. There are 43 character variables available. I want to recode them where there is ordinality and where there isn’t dummify them.</p>
<p>There are two numerical variables that are actually date related: <code>YearBuilt</code>and <code>YearRemodAdd</code> (remodelled date). It makes more sense to make two new variables that relate the build and remodelled dates with the present. In other words, I will create the years since built and years since remodelled date variables, this will help interpret the results better.</p>
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:missigness-table">Table 3.1: </span>Variables with missing values in descending order
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Number of NAs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PoolQC
</td>
<td style="text-align:right;">
1453
</td>
</tr>
<tr>
<td style="text-align:left;">
MiscFeature
</td>
<td style="text-align:right;">
1406
</td>
</tr>
<tr>
<td style="text-align:left;">
Alley
</td>
<td style="text-align:right;">
1369
</td>
</tr>
<tr>
<td style="text-align:left;">
Fence
</td>
<td style="text-align:right;">
1179
</td>
</tr>
<tr>
<td style="text-align:left;">
FireplaceQu
</td>
<td style="text-align:right;">
690
</td>
</tr>
<tr>
<td style="text-align:left;">
LotFrontage
</td>
<td style="text-align:right;">
259
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageType
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageYrBlt
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageFinish
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageQual
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageCond
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtExposure
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtFinType2
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtQual
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtCond
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtFinType1
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:left;">
MasVnrType
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
MasVnrArea
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Electrical
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>19 variables have missing values.</p>
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:correlations-table">Table 3.2: </span>Top 16 correlations with SalePrice
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Correlation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
OverallQual
</td>
<td style="text-align:right;">
0.7909816
</td>
</tr>
<tr>
<td style="text-align:left;">
GrLivArea
</td>
<td style="text-align:right;">
0.7086245
</td>
</tr>
<tr>
<td style="text-align:left;">
ExterQual
</td>
<td style="text-align:right;">
0.6826392
</td>
</tr>
<tr>
<td style="text-align:left;">
KitchenQual
</td>
<td style="text-align:right;">
0.6595997
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageCars
</td>
<td style="text-align:right;">
0.6404092
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageArea
</td>
<td style="text-align:right;">
0.6234314
</td>
</tr>
<tr>
<td style="text-align:left;">
TotalBsmtSF
</td>
<td style="text-align:right;">
0.6135806
</td>
</tr>
<tr>
<td style="text-align:left;">
X1stFlrSF
</td>
<td style="text-align:right;">
0.6058522
</td>
</tr>
<tr>
<td style="text-align:left;">
BsmtQual
</td>
<td style="text-align:right;">
0.5852072
</td>
</tr>
<tr>
<td style="text-align:left;">
FullBath
</td>
<td style="text-align:right;">
0.5606638
</td>
</tr>
<tr>
<td style="text-align:left;">
GarageFinish
</td>
<td style="text-align:right;">
0.5492468
</td>
</tr>
<tr>
<td style="text-align:left;">
TotRmsAbvGrd
</td>
<td style="text-align:right;">
0.5337232
</td>
</tr>
<tr>
<td style="text-align:left;">
FireplaceQu
</td>
<td style="text-align:right;">
0.5204376
</td>
</tr>
<tr>
<td style="text-align:left;">
YearsSinceRemod
</td>
<td style="text-align:right;">
-0.5071010
</td>
</tr>
<tr>
<td style="text-align:left;">
YearsSinceGarageBuilt
</td>
<td style="text-align:right;">
-0.5080433
</td>
</tr>
<tr>
<td style="text-align:left;">
YearsSinceBuilt
</td>
<td style="text-align:right;">
-0.5228973
</td>
</tr>
</tbody>
</table>
</div>
<div id="data-exploration" class="section level1">
<h1><span class="header-section-number">4</span> Data exploration</h1>
<p>First we will check that there is no multicolinearity amongst highly correlated variables. <em>explain here what is multicolinearity</em>.</p>
<pre><code>          OverallQual             GrLivArea             ExterQual 
             3.597804              5.196407              2.893796 
          KitchenQual            GarageCars            GarageArea 
             2.598119              5.474476              5.427985 
          TotalBsmtSF             X1stFlrSF              BsmtQual 
             5.184842              4.686977              2.862181 
             FullBath          GarageFinish          TotRmsAbvGrd 
             2.249522              1.981747              3.367677 
          FireplaceQu       YearsSinceRemod YearsSinceGarageBuilt 
             1.562849              2.165483              4.730174 
      YearsSinceBuilt 
             4.542988 </code></pre>
<p>Variables with a vif above 5 are multicolinear with other explanatory variables. These were <code>GrLiveArea</code>, <code>GarageCars</code>, and <code>TotalBsmtSF</code>.</p>
<pre><code>          OverallQual             ExterQual           KitchenQual 
             3.448267              2.884464              2.596205 
           GarageArea             X1stFlrSF              BsmtQual 
             2.206103              1.603596              2.002222 
             FullBath          GarageFinish          TotRmsAbvGrd 
             2.043929              1.932250              1.813619 
          FireplaceQu       YearsSinceRemod YearsSinceGarageBuilt 
             1.512568              2.136858              4.670829 
      YearsSinceBuilt 
             4.411479 </code></pre>
<p>After removing predictors that were related amongst themselves, the top 13 variables most (above 0.5) correlated with <code>SalesPrice</code> were:</p>
<p><strong>Positive correlation</strong></p>
<ul>
<li><code>OverallQual</code>: Rates the overall material and finish of the house</li>
<li><code>ExterQual</code>: Exterior quality</li>
<li><code>KitchenQual</code>: Kitchen quality</li>
<li><code>GarageArea</code>: Size of garage in square feet</li>
<li><code>X1stFlrSF</code>: First floor square feet</li>
<li><code>BsmtQual</code>: Height of basement</li>
<li><code>FullBath</code>: Full bathrooms above grade</li>
<li><code>GarageFinish</code>: Interior finish of the garage</li>
<li><code>TotRmsAbvGrd</code>: Total rooms above grade (does not include bathrooms)</li>
<li><code>FireplaceQu</code>: Fireplace quality</li>
</ul>
<p><strong>Negative correlation</strong></p>
<ul>
<li><code>YearsSinceRemod</code>: Years since remodel date (same as construction date if no remodelling or additions)</li>
<li><code>YearsSinceGarageBuilt</code>: Years since the garage was built</li>
<li><code>YearsSinceBuilt</code>: Years since construction date</li>
</ul>
<p><strong>Numeric variables</strong></p>
<p><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/high-cor-geompoint-1.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/high-cor-geompoint-2.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/high-cor-geompoint-3.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/high-cor-geompoint-4.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/high-cor-geompoint-5.png" width="672" /></p>
<p><strong>Categorical variables</strong></p>
<p><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-1.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-2.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-3.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-4.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-5.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-6.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-7.png" width="672" /><img src="/post/2018-08-09-predicting-property-prices_files/figure-html/plotting%20categorical%20variables-8.png" width="672" /></p>
</div>
<div id="techniques-used" class="section level1">
<h1><span class="header-section-number">5</span> Techniques used</h1>
<ul>
<li>I</li>
</ul>
</div>
<div id="questions-from-this-analysis" class="section level1">
<h1><span class="header-section-number">6</span> Questions from this analysis</h1>
<ul>
<li></li>
</ul>
</div>
