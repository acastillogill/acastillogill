---
title: Rossman stores sales
author: √Ångela D. Castillo-Gill
date: '2018-09-24'
slug: rossman-stores-sales
categories:
  - R
  - EDA
tags: 
  - Kaggle
  - Rossmanblogdown::serve_site()

output:
  blogdown::html_page:
    toc: true
    number_sections: true
    toc_depth: 2
  fig_caption: true
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
x <-
  c("tidyverse",
    "knitr",
    "formatR",
    "stringr",
    "quantmode",
    "skimr",
    "lubridate",
    "tidyr",
    "formattable",
    "grid",
    "gridExtra",
    "kableExtra",
    "corrplot")

lapply(x, require, character.only = TRUE)


opts_chunk$set(echo = FALSE,
               warning = FALSE,
               error = FALSE,
               message = FALSE,
               collapse= TRUE,
               comment = NA,
               tidy = TRUE)
```

# Summary



# Purpose of this post


# The data

The data was obtained from the [Kaggle platform](https://www.kaggle.com/c/rossmann-store-sales/kernels?sortBy=hotness&group=everyone&pageSize=20&language=R&outputType=Data&competitionId=4594&kernelType=all).

```{r results='hide', message=FALSE}
path <- "/Volumes/TOSHIBAEXT/RStudio/blog/content/post/rossman_sales/"
#Read `trained_filled_gap.csv`
rossman <- read_csv(paste0(path,"train.csv"))
```

```{r}
#See dataset structure
str(rossman, give.attr = FALSE)
```

```{r}
# Visualization of correlations
rossman %>% select_if(is.numeric) %>%
  dplyr::select(-Store,-DayOfWeek) %>%
  cor()%>%
  corrplot()
```

```{r}
# Frequent days of week
ggplot(rossman) +
    geom_boxplot(aes(x = as.character(DayOfWeek), y = Sales))
```

```{r}
# Frequent days of week
ggplot(rossman) +
    geom_boxplot(aes(x = as.character(Promo), y = Sales))
```


The codebook was included in the Kaggle description: 

- `customerID`: "Customer ID"
- `gender`: "The amount disbursed by the field agent to the borrower(USD)"
- `SeniorCitizen`: "More granular category"
- `sector`: "High level category"
- `use`: "Exact usage of loan amount"
- `country_code`: "ISO country code of country in which loan was disbursed"
- `country`: "Full country name of country in which loan was disbursed"
- `region`: "Full region name within the country"
- `currency`: "The currency in which the loan was disbursed"
- `partner_id`: "ID of partner organization"

This variable has a lot of missing values and the Kiva explanation on Kaggle doesn't go much further. For now, I will exclude `partner_id`. 

- `posted_time`: "The time at which the loan is posted on Kiva by the field agent"
- `disbursed_time`: "The time at which the loan is disbursed by the field agent to the borrower"
- `funded_time`: "The time at which the loan posted to Kiva gets funded by lenders completely"
- `term_in_months`: "The duration for which the loan was disbursed in months"
- `lender_count`: "The total number of lenders that contributed to this loan"
- `borrower_genders`: "Comma separated M,F letters, where each instance represents a single male/female in the group"
- `repayment_interval`: Not specified so we'll assume that it means the standard definition of when the loan is repaid back to the lender.

# Data cleaning 
```{r}

#Select variables 
kiva_loans %>%
  dplyr::select (id,
          loan_amount,
          sector,
          country_code,
          currency,
          posted_time,
          disbursed_time,
          term_in_months,
          lender_count,
          borrower_genders,
          repayment_interval,
          funded_time) -> kiva_loans

#Convert country_code, sector, currency, borrower_genders, and repayment_interval to factors.
categorical <- c("sector",
                 "country_code",
                 "currency",
                 "borrower_genders",
                 "repayment_interval")

kiva_loans[categorical] <- lapply(kiva_loans[categorical],
                                  factor)
```

From  at the structure of our data, we can soon see there are a few bits that don't make sense and need to be fixed. 

**a. Missing values**




# Exploratory data analysis



# Techniques used



# Questions from this analysis


