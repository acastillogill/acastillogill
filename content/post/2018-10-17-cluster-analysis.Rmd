---
title: "Cluster analysis: wear your seatbelts"
author: √Ångela Castillo-Gill
date: '2018-10-17'
slug: cluster-analysis-wear-your-seatbelts
categories: []
tags: 
  - Cluster Analysis
description: "I do hierarchical clustering on the seatbelts dataset."
banner: "banners/cluster.png"
images: ["banners/cluster.png"]
draft: FALSE
header: 
  image: "banners/cluster.png"
  caption: ""
output:
  blogdown::html_page:
    toc: true
    number_sections: true
    toc_depth: 2
  fig_caption: true
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
x <-
  c("dplyr",
    "knitr",
    "here",
    "scales",
    "magrittr",
    "ggplot2",
    "cowplot",
    "tidyverse",
    "Metrics",
    "rsample",
    "broom",
    "sf",
    "rgdal",
    "summarytools",
    "tmap",
    "tmaptools",
    "lubridate",
    "RColorBrewer",
    "hrbrthemes",
    "ggrepel",
    "dummies",
    "stats")


lapply(x, require, character.only = TRUE)


opts_chunk$set(echo = FALSE,
               warning = FALSE,
               error = FALSE,
               message = FALSE,
               collapse = TRUE,
               comment = NA,
               tidy = TRUE,
               include = FALSE)

theme_set(theme_ipsum_rc())

options(
  digits=4,
  scipen = 999
)


knit_hooks$set(inline = function(x) {
  prettyNum(round(x,4), big.mark=",")
})



seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- round((seatbelts$date-seatbelts$year)*12+1, digits = 0)
seatbelts$month <- as.factor(seatbelts$month)
seatbelts$law <- as.factor(seatbelts$law)
seatbelts$year <- as.factor(seatbelts$year)
seatbelts$date <- NULL
```

# Summary

*To see the all the code used in this post, visit my [GitHub repository for this site](https://github.com/acastillogill/acastillogill)* 

- Objectives: To find what what kind of clusters are there in the seatbelts dataset. 
- Challenge: To implement a clustering algorithm for the first time.
- Data points: `r length(seatbelts)*nrow(seatbelts)`
- Language: R 


# Question


**What types of clusters are there in the seatbelts dataset?**

# Dataset description 

```{r converting-month-to-dummy}
#Remove categorical variables
num_seatbelts <- seatbelts[,1:7]
#scale numeric variables
num_seatbelts <- scale(num_seatbelts)
```



```{r hierarchical-clustering}
dist_seat <- dist(num_seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)

count(seat_k2_complete, cluster)

ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
  geom_jitter()+
  scale_color_brewer(palette="Dark2")
```


# Results

# Conclusion


