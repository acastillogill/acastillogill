# fig.width = 25,
#  out.extra='angle=90',
#  fig.align='center',
#    fig.asp=0.5,
#   fig.crop=FALSE)
#Set theme
theme_set(theme_ipsum_rc())
#Set number of digits
options(
digits=4,
scipen = 999
)
#Set number of inline digits
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
extrafont::loadfonts()
# Chunk 2: read-data
# Read data
NBA <- read_csv(here::here("static","data","free_throws.csv"))
# Chunk 3: assign-correct-variable-type
#Assign factor columns to a vector factors
factors <- c("end_result",
"game",
"game_id",
"play",
"player",
"playoffs",
"score",
"season")
#Assign factor type to factors
NBA[factors] <- lapply(NBA[factors], factor)
# Chunk 4: NBA-regular-vs-playoffs
#Create a regular season dataset
NBA_reg <- NBA%>%
filter(playoffs=="regular")
#Create a playoffs dataset
NBA_play <- NBA%>%
filter(playoffs=="playoffs")
# Chunk 5: stats-all-time
all_NBA_reg <- NBA_reg%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
head(10)
all_NBA_play <- NBA_play%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
head(10)
# Chunk 6: stats-per-season
season_NBA_reg <- NBA_reg%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
season_NBA_play <- NBA_play%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
# Chunk 7: creating-colour-palette
blues <- brewer.pal(9,"Blues")
blue_range <- colorRampPalette(blues)
reds <- brewer.pal(9,"Reds")
red_range <- colorRampPalette(reds)
# Chunk 8: all-time-shots-col
all_time_shots_reg <- all_NBA_reg%>%
mutate(player=fct_reorder(player, shots))%>%
ggplot(aes(x=player,y=shots))+
geom_col(fill=blue_range(10))+
coord_flip()+
labs(
title="Total shots, top ten players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Total shots")
all_time_shots_play  <- all_NBA_play%>%
mutate(player=fct_reorder(player, shots))%>%
ggplot(aes(x=player,y=shots))+
geom_col(fill=red_range(10))+
coord_flip()+
labs(
title="Total shots, top ten players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Total shots")
all_time_shots <- plot_grid(all_time_shots_reg,
all_time_shots_play,
nrow=2)
all_time_shots
# Chunk 9: all-time-ratio-col
best_players_plot_ratio_reg <- all_NBA_reg%>%
mutate(player=fct_reorder(player, shots_attempts_ratio))%>%
ggplot(aes(x=player,y=shots_attempts_ratio))+
geom_col(fill=blue_range(10))+
coord_flip()+
labs(title="Shots per free throws, top ten players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Shots per free throws")+
theme(text = element_text(size=30))+
scale_y_comma(labels = scales::percent_format())
best_players_plot_ratio_play <- all_NBA_play%>%
mutate(player=fct_reorder(player, shots_attempts_ratio))%>%
ggplot(aes(x=player,y=shots_attempts_ratio))+
geom_col(fill=red_range(10))+
coord_flip()+
labs(title="Shots per free throws, top ten players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Shots per free throws")+
theme(text = element_text(size=30))+
scale_y_comma(labels = scales::percent_format())
all_time_ratio <- plot_grid(best_players_plot_ratio_reg,
best_players_plot_ratio_play,
nrow=2)
all_time_ratio
# Chunk 10: season-shots-point
season_players_plot_shots_reg <-  season_NBA_reg%>%
ggplot(aes(x=season,y=shots))+
geom_point(size=5, color="Blue", alpha=0.3)+
labs(title="Total shots, top annual players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Total shots") +
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
expand_limits(y=400)
season_players_plot_shots_play <-  season_NBA_play%>%
ggplot(aes(x=season,y=shots))+
geom_point(size=5, color="Red", alpha=0.3)+
labs(title="Total shots, top annual players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Total shots") +
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
expand_limits(y=120)
season_shots <- plot_grid(season_players_plot_shots_reg,
season_players_plot_shots_play,
nrow=2)
season_shots
# Chunk 11: season-ratios-point
season_players_plot_ratio_reg <- season_NBA_reg%>%
ggplot(aes(x=season,y=shots_attempts_ratio))+
geom_point(size=5, color="Blue", alpha=0.3)+
labs(title="Shots per free throws, top annual players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Shots per free throws")+
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_y_comma(labels = scales::percent_format())+
expand_limits(y=c(0.7,0.95))
season_players_plot_ratio_play <- season_NBA_play%>%
ggplot(aes(x=season,y=shots_attempts_ratio))+
geom_point(size=5, color="red", alpha=0.3)+
labs(title="Shots per free throws, top annual players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Shots per free throws")+
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_y_comma(labels = scales::percent_format())+
expand_limits(y=c(0.7,0.95))
season_ratios <- plot_grid(season_players_plot_ratio_reg,
season_players_plot_ratio_play,
nrow=2)
season_ratios
nested_NBA_reg%>%
mutate(data=map(data, ~.x%>%
group_by(player)%>%
summarise(shots_made=sum(shot_made),
total_attempts=n(),
free_throw_ratio=sum(shot_made)/n())%>%
arrange(desc(shots_made))%>%
top_n(1)
))%>%
unnest
# Chunk 1: setup
#Load packages
x <-
c("knitr",
"here",
"tidyverse",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"gridExtra",
"cowplot")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = TRUE,
fig.height = 10)
# fig.width = 25,
#  out.extra='angle=90',
#  fig.align='center',
#    fig.asp=0.5,
#   fig.crop=FALSE)
#Set theme
theme_set(theme_ipsum_rc())
#Set number of digits
options(
digits=4,
scipen = 999
)
#Set number of inline digits
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
extrafont::loadfonts()
# Chunk 2: read-data
# Read data
NBA <- read_csv(here::here("static","data","free_throws.csv"))
# Chunk 3: assign-correct-variable-type
#Assign factor columns to a vector factors
factors <- c("end_result",
"game",
"game_id",
"play",
"player",
"playoffs",
"score",
"season")
#Assign factor type to factors
NBA[factors] <- lapply(NBA[factors], factor)
# Chunk 4: NBA-regular-vs-playoffs
#Create a regular season dataset
NBA_reg <- NBA%>%
filter(playoffs=="regular")
#Create a playoffs dataset
NBA_play <- NBA%>%
filter(playoffs=="playoffs")
# Chunk 5: stats-all-time
all_NBA_reg <- NBA_reg%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
head(10)
all_NBA_play <- NBA_play%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
head(10)
# Chunk 6: stats-per-season
season_NBA_reg <- NBA_reg%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
season_NBA_play <- NBA_play%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
# Chunk 7: creating-colour-palette
blues <- brewer.pal(9,"Blues")
blue_range <- colorRampPalette(blues)
reds <- brewer.pal(9,"Reds")
red_range <- colorRampPalette(reds)
# Chunk 8: all-time-shots-col
all_time_shots_reg <- all_NBA_reg%>%
mutate(player=fct_reorder(player, shots))%>%
ggplot(aes(x=player,y=shots))+
geom_col(fill=blue_range(10))+
coord_flip()+
labs(
title="Total shots, top ten players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Total shots")
all_time_shots_play  <- all_NBA_play%>%
mutate(player=fct_reorder(player, shots))%>%
ggplot(aes(x=player,y=shots))+
geom_col(fill=red_range(10))+
coord_flip()+
labs(
title="Total shots, top ten players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Total shots")
all_time_shots <- plot_grid(all_time_shots_reg,
all_time_shots_play,
nrow=2)
all_time_shots
# Chunk 9: all-time-ratio-col
best_players_plot_ratio_reg <- all_NBA_reg%>%
mutate(player=fct_reorder(player, shots_attempts_ratio))%>%
ggplot(aes(x=player,y=shots_attempts_ratio))+
geom_col(fill=blue_range(10))+
coord_flip()+
labs(title="Shots per free throws, top ten players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Shots per free throws")+
theme(text = element_text(size=30))+
scale_y_comma(labels = scales::percent_format())
best_players_plot_ratio_play <- all_NBA_play%>%
mutate(player=fct_reorder(player, shots_attempts_ratio))%>%
ggplot(aes(x=player,y=shots_attempts_ratio))+
geom_col(fill=red_range(10))+
coord_flip()+
labs(title="Shots per free throws, top ten players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Shots per free throws")+
theme(text = element_text(size=30))+
scale_y_comma(labels = scales::percent_format())
all_time_ratio <- plot_grid(best_players_plot_ratio_reg,
best_players_plot_ratio_play,
nrow=2)
all_time_ratio
# Chunk 10: season-shots-point
season_players_plot_shots_reg <-  season_NBA_reg%>%
ggplot(aes(x=season,y=shots))+
geom_point(size=5, color="Blue", alpha=0.3)+
labs(title="Total shots, top annual players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Total shots") +
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
expand_limits(y=400)
season_players_plot_shots_play <-  season_NBA_play%>%
ggplot(aes(x=season,y=shots))+
geom_point(size=5, color="Red", alpha=0.3)+
labs(title="Total shots, top annual players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Total shots") +
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
expand_limits(y=120)
season_shots <- plot_grid(season_players_plot_shots_reg,
season_players_plot_shots_play,
nrow=2)
season_shots
# Chunk 11: season-ratios-point
season_players_plot_ratio_reg <- season_NBA_reg%>%
ggplot(aes(x=season,y=shots_attempts_ratio))+
geom_point(size=5, color="Blue", alpha=0.3)+
labs(title="Shots per free throws, top annual players (2006/16)",
subtitle = "Regular season, players ranked by total shots.",
x="",
y="Shots per free throws")+
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_y_comma(labels = scales::percent_format())+
expand_limits(y=c(0.7,0.95))
season_players_plot_ratio_play <- season_NBA_play%>%
ggplot(aes(x=season,y=shots_attempts_ratio))+
geom_point(size=5, color="red", alpha=0.3)+
labs(title="Shots per free throws, top annual players (2006/16)",
subtitle = "Playoffs season, players ranked by total shots.",
x="",
y="Shots per free throws")+
geom_text_repel(aes(label=player), force=10, size=3, segment.alpha = 0.5)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_y_comma(labels = scales::percent_format())+
expand_limits(y=c(0.7,0.95))
season_ratios <- plot_grid(season_players_plot_ratio_reg,
season_players_plot_ratio_play,
nrow=2)
season_ratios
NBA_play%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
NBA_reg%>%
group_by(season)%>%
nest() %>%
mutate(data = map(data, ~ .x %>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)
)) %>%
unnest
NBA_reg%>%
group_by(season)%>%
nest()
#Load packages
x <-
c("knitr",
"here",
"tidyverse",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"gridExtra",
"cowplot")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = TRUE,
fig.height = 10)
# fig.width = 25,
#  out.extra='angle=90',
#  fig.align='center',
#    fig.asp=0.5,
#   fig.crop=FALSE)
#Set theme
theme_set(theme_ipsum_rc())
#Set number of digits
options(
digits=4,
scipen = 999
)
#Set number of inline digits
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
extrafont::loadfonts()
NBA_reg%>%
group_by(season)%>%
nest()
NBA_reg%>%
group_by(season)%>%
nest()
NBA_reg%>%
group_by(season)%>%
nest()%>%
mutate(data=map(data, ~.x%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shots_made))%>%
arrange(desc(shots))%>%
top_n(1)
))%>%
unnest()
NBA_reg%>%
group_by(season)%>%
nest()%>%
mutate(data=map(data, ~.x%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shots_made))%>%
arrange(desc(shots))%>%
top_n(1)))%>%
unnest()
NBA_reg%>%
group_by(season)%>%
nest()%>%
mutate(data=map(data, ~.x%>%
group_by(player)%>%
summarise(shots_attempts_ratio=sum(shot_made)/n(),
total_attempts=n(),
shots=sum(shot_made))%>%
arrange(desc(shots))%>%
top_n(1)))%>%
unnest()
blogdown::serve_site()
