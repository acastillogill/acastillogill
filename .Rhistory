"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- (seatbelts$date-seatbelts$year)*12+1
(seatbelts$date-seatbelts$year)
seatbelts$date-seatbelts$year)*12+1
head(seatbelts)
seatbelts_scaled <- scale(seatbelts)
head(seatbelts_scaled)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- (seatbelts$date-seatbelts$year)*12+1
head(seatbelts)
library(dummies)
seatbelts$month <- dummy.data.frame(seatbelts$month)
dummy.data.frame(seatbelts$month)
dummy.data.frame(seatbelts)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"dummies")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- (seatbelts$date-seatbelts$year)*12+1
seatbelts$month <- as.factor(seatbelts$month)
seatbelts$law <- as.factor(seatbelts$law)
seatbelts$year <- as.factor(seatbelts$year)
str(seatbelts)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"dummies")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- round((seatbelts$date-seatbelts$year)*12+1, digits = 0)
seatbelts$month <- as.factor(seatbelts$month)
seatbelts$law <- as.factor(seatbelts$law)
seatbelts$year <- as.factor(seatbelts$year)
str(seatbelts)
View(seatbelts)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"dummies")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- round((seatbelts$date-seatbelts$year)*12+1, digits = 0)
seatbelts$month <- as.factor(seatbelts$month)
seatbelts$law <- as.factor(seatbelts$law)
seatbelts$year <- as.factor(seatbelts$year)
seatbelts$date <- NULL
str(seatbelts)
seatbelts[, 7:3]
seatbelts[, 7:10]
seatbelts[, 8:10]
cat_seatbelts <- seatbelts[, 8:10]
dummy.data.frame(cat_seatbelts)
seatbelts[,1:7]
head(seatbelts[,1:7])
cat_seatbelts <- seatbelts[, 8:10]
cat_seatbelts <- dummy.data.frame(cat_seatbelts)
num_seatbelts <- seatbelts[,1:7]
#scale numeric variables
num_seatbelts <- scale(num_seatbelts)
head(num_seatbelts)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"dummies")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=4,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
seatbelts <- data.frame(as.matrix(datasets::Seatbelts), date=time(datasets::Seatbelts))
seatbelts$year <- trunc(seatbelts$date)
seatbelts$month <- round((seatbelts$date-seatbelts$year)*12+1, digits = 0)
seatbelts$month <- as.factor(seatbelts$month)
seatbelts$law <- as.factor(seatbelts$law)
seatbelts$year <- as.factor(seatbelts$year)
seatbelts$date <- NULL
#Dummify categorical variables
cat_seatbelts <- seatbelts[, 8:10]
cat_seatbelts <- dummy.data.frame(cat_seatbelts)
#scale numeric variables
num_seatbelts <- seatbelts[,1:7]
num_seatbelts <- scale(num_seatbelts)
#Join both dataframes
full_seatbelts <- cbind(cat_seatbelts,num_seatbelts)
head(full_seatbelts)
help(hclust)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_kd_complete <- mutate(seatbelts, cluster=clusters_k2)
seat_kd_complete
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = x, y = y, color = factor(cluster))) +
geom_point()
seat_k2_complete
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_point()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=3)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=4)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = deaths, color = factor(cluster))) +
geom_jitter()
names(seat_k2_complete)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_point()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_bar()
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_bar(stat="identity")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_point(alpha=0.3)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter(alpha=0.3)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter(alpha=0.7)
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter(alpha=0.7)+
scale_color_brewer(palette="Spectral")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Spectral")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
dist_seat <- dist(seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = month, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
#Remove categorical variables
num_seatbelts <- seatbelts[,1:7]
#scale numeric variables
num_seatbelts <- scale(num_seatbelts)
dist_seat <- dist(num_seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = month, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
dist_seat <- dist(num_seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=3)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = month, y = DriversKilled, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
dist_seat <- dist(num_seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=3)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
dist_seat <- dist(num_seatbelts, method = "euclidean")
hc_seat <- hclust(dist_seat, method = "complete")
clusters_k2 <- cutree(hc_seat, k=2)
seat_k2_complete <- mutate(seatbelts, cluster=clusters_k2)
count(seat_k2_complete, cluster)
ggplot(seat_k2_complete, aes(x = law, y = month, color = factor(cluster))) +
geom_jitter()+
scale_color_brewer(palette="Dark2")
blogdown::serve_site()
knitr::opts_chunk$set(echo = TRUE)
x <-
c("shiny",
"knitr",
"here",
"scales",
"cowplot",
"tidyverse",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel",
"googlesheets")
lapply(x, require, character.only = TRUE)
theme_set(theme_ipsum_rc())
knit_hooks$set(inline = function(x) {
prettyNum(round(x,4), big.mark=",")
})
money_gs <-  gs_title("Money tracker (Responses)")
money <- gs_read(money_gs)
help("plotOutput")
