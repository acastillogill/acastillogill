opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_light())
options(
digits=3,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,2), big.mark=",")
})
r_downloads <- readRDS(file=here::here("static","data","r-downloads.rds"))
r_downloads <- na.omit(r_downloads)%>%
filter(date<"2018-10-20")
# Chunk 2: read-data
iso_codes <- read_csv(here::here("static","data","iso_countries.csv"))
pop <-read_csv(here::here("static","data","country_populations.csv"))
map_path <- here::here("static","data","world_shapefile","world_shapefile.shp")
world <- sf::st_read(map_path)
educ <- read_csv(here::here("static","data","edu_year.csv"))
educ$edu_index <- as.double(educ$edu_index)
# Chunk 3: merge-country-codes
r_downloads%<>%
full_join(iso_codes, by=c("country"="iso"))%>%
filter(!is.na(sub_region))
# Chunk 4: downloads-by-country
r_downloads%>%
group_by(name)%>%
summarise(n=n())%>%
filter(!is.na(n))%>%
arrange(desc(n))->downloads_per_country
# Chunk 5: merge-years-of-education
full_maps_edu <- full_maps%>%
left_join(educ, by="name")%>%
na.omit()
educ_vs_n_capita_plot <- ggplot(full_maps_edu, aes(x=edu_index, y=n_capita))+
geom_point(alpha=0.5)+
theme_ipsum_rc()+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
educ_vs_n_capita_plot
ggplot(full_maps_edu, aes(x=edu_index, y=n_capita))+
geom_point(alpha=0.5)+
theme_ipsum_rc()+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
# Chunk 1: setup
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_light())
options(
digits=3,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,2), big.mark=",")
})
r_downloads <- readRDS(file=here::here("static","data","r-downloads.rds"))
r_downloads <- na.omit(r_downloads)%>%
filter(date<"2018-10-20")
# Chunk 2: read-data
iso_codes <- read_csv(here::here("static","data","iso_countries.csv"))
pop <-read_csv(here::here("static","data","country_populations.csv"))
map_path <- here::here("static","data","world_shapefile","world_shapefile.shp")
world <- sf::st_read(map_path)
educ <- read_csv(here::here("static","data","edu_year.csv"))
educ$edu_index <- as.double(educ$edu_index)
# Chunk 3: merge-country-codes
r_downloads%<>%
full_join(iso_codes, by=c("country"="iso"))%>%
filter(!is.na(sub_region))
# Chunk 4: downloads-by-country
r_downloads%>%
group_by(name)%>%
summarise(n=n())%>%
filter(!is.na(n))%>%
arrange(desc(n))->downloads_per_country
# Chunk 5: merge-years-of-education
full_maps_edu <- full_maps%>%
left_join(educ, by="name")%>%
na.omit()
# Chunk 6: plot-relationship-between-educ-and-n-capita
ggplot(full_maps_edu, aes(x=edu_index, y=n_capita))+
geom_point(alpha=0.5)+
theme_ipsum_rc()+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
# Chunk 7: create-model-of-educ-r-capita
fit <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit)
par(mfrow=c(2,2))
plot(fit)
ggplot(full_maps_edu, aes(x=edu_index, y=n_capita))+
geom_point(alpha=0.5)+
theme_ipsum_rc()+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
fit <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit)
plot(fit)
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=3,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,2), big.mark=",")
})
r_downloads <- readRDS(file=here::here("static","data","r-downloads.rds"))
r_downloads <- na.omit(r_downloads)%>%
filter(date<"2018-10-20")
ggplot(full_maps_edu, aes(x=edu_index, y=n_capita))+
geom_point(alpha=0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
blogdown::serve_site()
fit <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit)
plot(fit)
fit <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit)
plot(fit)
identify(fit)
names(full_maps_edu)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text(aes(label=name))+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
library(ggrepel)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name))+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=0.1)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=1)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
View(full_maps_edu)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=2)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
fit <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit)
plot(fit)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=2)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
args(geom_text_repel)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm")+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon")+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
args(geom_smooth)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE)+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE)+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita (logarithm applied)")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE)+
geom_text_repel(aes(label=name), force=0.2, size=3, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita (logarithm applied)")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE, size=4, alpha=0.5)+
geom_text_repel(aes(label=name), force=0.2, size=3, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita (logarithm applied)")
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE, size=2, alpha=0.5)+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita (logarithm applied)")
fit%>%tidy()
fit%>%augment()
fit%>%glance()
coef(summary(fit))$adj.r.squared
summary(fit)$adj.r.squared
summary(fit)$adj.r.squared*100
names(full_maps_edu)
nested <- full_maps_edu%>%
group_by(region)%>%
nest()
#Nest models
nested <- full_maps_edu%>%
group_by(region)%>%
nest()
#Create linear regression
models <- nested%>%
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))
head(models)
#Nest models
full_maps_edu%>%
group_by(region)%>%
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Coefficients of many models
mutate(coef=map(model~glance(x)))%>%
unnest()
#Nest models
full_maps_edu%>%
group_by(region)%>%
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Coefficients of many models
mutate(coef=map(model~glance(.x)))%>%
unnest()
#Nest models
full_maps_edu%>%
group_by(region)%>%
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Coefficients of many models
mutate(coef=map(model,~glance(.x)))%>%
unnest()
#Nest models
full_maps_edu%>%
group_by(region)%>%
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Coefficients of many models
mutate(coef=map(model,~glance(.x)))%>%
unnest()
#Nest models
full_maps_edu%>%
group_by(region)%>%
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Coefficients of many models
mutate(coef=map(model,~glance(.x)))%>%
unnest(coef)
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE, size=2, alpha=0.5)+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita",
x="Education index",
y="R downloads per capita (logarithm applied)")+
facet_wrap(.~region, scales="free")
full_maps_edu[-outliers,]
outliers <- c(160,148,140,95,162)
full_maps_edu[-outliers,]
outliers <- c(160,148,140,95,162)
full_maps_edu_sans_outliers <- full_maps_edu[-outliers,]
fit_2 <- lm( log(n_capita) ~ edu_index, data = full_maps_edu)
summary(fit_2)
plot(fit_2)
outliers <- c(160,148,140,95,162)
full_maps_edu_sans_outliers <- full_maps_edu[-outliers,]
fit_2 <- lm( log(n_capita) ~ edu_index, data = full_maps_edu_sans_outliers)
summary(fit_2)
plot(fit_2)
full_maps_edu_sans_outliers%>%
group_by(region)%>%
#Nest models
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Metrics of all models
mutate(coef=map(model,~glance(.x)))%>%
#Models
unnest(coef)
full_maps_edu_sans_outliers%>%
group_by(region)%>%
#Nest models
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Metrics of all models
mutate(coef=map(model,~glance(.x)))%>%
#Models
unnest(coef)%>%
kable()
full_maps_edu_sans_outliers%>%
group_by(region)%>%
#Nest models
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Metrics of all models
mutate(coef=map(model,~glance(.x)))%>%
#Models
unnest(coef)
full_maps_edu_sans_outliers%>%
group_by(region)%>%
#Nest models
nest()%>%
#Create linear regression
mutate(model=map(data,~lm(formula=log(n_capita) ~ edu_index, data=.x)))%>%
#Metrics of all models
mutate(coef=map(model,~glance(.x)))%>%
#Models
unnest(coef)%>%
select(region, adj.r.squared)%>%
kable()
ggplot(full_maps_edu, aes(x=edu_index, y=log(n_capita)))+
geom_point(alpha=0.5)+
geom_smooth(method="lm", color="salmon", se=FALSE, size=2, alpha=0.5)+
geom_text_repel(aes(label=name), force=0.2, size=2, segment.alpha = 0.5)+
labs(title="The education index vs. R downloads per capita by region",
x="Education index",
y="R downloads per capita (logarithm applied)")+
facet_wrap(.~region, scales="free")
blogdown::serve_site()
# Chunk 1: setup
x <-
c("dplyr",
"knitr",
"here",
"scales",
"magrittr",
"ggplot2",
"cowplot",
"tidyverse",
"Metrics",
"rsample",
"broom",
"sf",
"rgdal",
"summarytools",
"tmap",
"tmaptools",
"lubridate",
"RColorBrewer",
"hrbrthemes",
"ggrepel")
lapply(x, require, character.only = TRUE)
opts_chunk$set(echo = FALSE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse = TRUE,
comment = NA,
tidy = TRUE,
include = FALSE)
theme_set(theme_ipsum_rc())
options(
digits=3,
scipen = 999
)
knit_hooks$set(inline = function(x) {
prettyNum(round(x,2), big.mark=",")
})
r_downloads <- readRDS(file=here::here("static","data","r-downloads.rds"))
r_downloads <- na.omit(r_downloads)%>%
filter(date<"2018-10-20")
# Chunk 2: read-data
iso_codes <- read_csv(here::here("static","data","iso_countries.csv"))
pop <-read_csv(here::here("static","data","country_populations.csv"))
map_path <- here::here("static","data","world_shapefile","world_shapefile.shp")
world <- sf::st_read(map_path)
educ <- read_csv(here::here("static","data","edu_year.csv"))
educ$edu_index <- as.double(educ$edu_index)
# Chunk 3: merge-country-codes
r_downloads%<>%
full_join(iso_codes, by=c("country"="iso"))%>%
filter(!is.na(sub_region))
# Chunk 4: downloads-by-country
r_downloads%>%
group_by(name)%>%
summarise(n=n())%>%
filter(!is.na(n))%>%
arrange(desc(n))->downloads_per_country
full_maps_edu <- full_maps%>%
left_join(educ, by="name")%>%
na.omit()
blogdown::serve_site()
