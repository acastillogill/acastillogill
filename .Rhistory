y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
downloads_hdi_plot<- downloads_hdi_country%>%
ggplot(aes(x=HDI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=percent_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Do R-Language downloads increase with more internet users?",
y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
downloads_hdi_country <-downloads_users_country%>%
right_join(human_dev_ind, by=c("name"="name"))%>%
arrange(desc(HDI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI))
downloads_hdi_plot<- downloads_hdi_country%>%
ggplot(aes(x=HDI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=percent_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Do R-Language downloads increase with more internet users?",
y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
cor(downloads_hdi_country)
cor(downloads_hdi_country$users,downloads_hdi_country$HDI)
downloads_hdi_plot<- downloads_hdi_country%>%
ggplot(aes(x=HDI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=percent_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Do R-Language downloads increase with more internet users?",
y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
cor(downloads_hdi_country$users,downloads_hdi_country$HDI)
cor(downloads_hdi_country$users,downloads_hdi_country$HDI)*100
downloads_hdi_plot<- downloads_hdi_country%>%
ggplot(aes(x=HDI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=percent_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Human Development Index (HDI) and R downloads.",
y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
hdi_fit <- lm(n ~ users + HDI, data=human_dev_ind)
summary(hdi_fit)$coef
hdi_fit <- lm(n ~ users + HDI, data=human_dev_ind)
hdi_fit <- lm(n ~ users + HDI, data=downloads_hdi_country)
summary(hdi_fit)$coef
0.02165956825<0.05
plot(hdi_fit)
summary(hdi_fit)
summary(hdi_fit)$r
summary(hdi_fit)$rsquared
summary(hdi_fit)$adj.r.squared
summary(hdi_fit)$adj.r.squared*100
internet_fit <- lm(n ~ users, data=downloads_hdi_country)
hdi_fit <- lm(n ~ users + HDI, data=downloads_hdi_country)
summary(hdi_fit)$coef
summary(internet_fit)
anova(internet_fit, hdi_fit)
blogdown::serve_site()
# Chunk 1: setup
library(tidyverse)
library(dplyr)
library(knitr)
library(here)
library(scales)
library(magrittr)
options(digits=4)
options(scipen = 999)
opts_chunk$set(echo = TRUE,
warning = FALSE,
error = FALSE,
message = FALSE,
collapse= TRUE,
comment = NA,
tidy = TRUE)
theme_set(theme_light())
r_downloads <- readRDS(file=here::here("static","data","r-downloads.rds"))
# Chunk 2: downloads-by-country
r_downloads%>%
group_by(country)%>%
summarise(n=n())%>%
arrange(desc(n))->downloads_per_country
# Chunk 3: read-country-codes
iso_codes <- read_csv(here("static","data","iso_countries.csv"))
# Chunk 4: merge-country-codes
downloads_per_country%<>%
right_join(iso_codes, by=c("country"="iso"))
# Chunk 5: top-20-countries-plot
downloads_per_country%>%
arrange(desc(n))%>%
filter(!is.na(name))%>%
head(20)%>%
mutate(name=fct_reorder(name,n))%>%
ggplot(aes(name,n,fill=name))+
geom_col()+
expand_limits(y=0)+
coord_flip()+
scale_y_continuous(labels=comma_format())+
labs(title="Top 20 countries by R downloads",
x="Country",
y="Downloads")+
theme(legend.position = "none")
# Chunk 6: read-internet-users
internet_users <-read_csv(here("static","data","internet_users.csv"))
# Chunk 7: merge-internet-users
downloads_users_country <-downloads_per_country%>%
right_join(internet_users, by=c("name"="name"))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n))%>%
arrange(desc(n))
# Chunk 8: downloads-internet-users-scatter-plot
library(plotly)
library(ggrepel)
downloads_internet_plot<- downloads_users_country%>%
arrange(desc(n))%>%
ggplot(aes(users, n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=comma_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Do R-Language downloads increase with more internet users?",
y="Downloads per country",
x="Internet users in each country")
ggplotly(downloads_internet_plot)%>%
layout(legend = list(orientation = "h", x = 0.4, y = -0.2))
# Chunk 9: fitting-model-first
internet_downloads_fit <- lm(n~users, data = downloads_users_country)
summary(internet_downloads_fit)$coef
par(mfrow=c(2,2))
plot(internet_downloads_fit)
# Chunk 10: dataset-without-outliers
downloads_users_country%>%
filter(name!="United Kingdom",
name!="Germany",
name!="China",
name!="India",
name!="United States of America",
name!="Brazil",
name!="Japan",
name!="Canada",
name!="Australia",
name!="Namibia")->outliers_gone
# Chunk 11: plot-without-outliers
downloads_internet_plot_out<- outliers_gone%>%
arrange(desc(n))%>%
ggplot(aes(users, n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=comma_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Do R-Language downloads increase with more internet users?",
subtitle = "China, India, United Kingdom, and Germany removed.",
y="Downloads per country",
x="Internet users in each country")
ggplotly(downloads_internet_plot_out)%>%
layout(legend = list(orientation = "h", x = 0.4, y = -0.2))
# Chunk 12: read-hdi-index
human_dev_ind <-read_csv(here("static","data","HDI.csv"))
# Chunk 13: merge-hdi-users
downloads_hdi_country <-downloads_users_country%>%
right_join(human_dev_ind, by=c("name"="name"))%>%
arrange(desc(HDI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI))
# Chunk 14: hdi-downloads-plot
downloads_hdi_plot<- downloads_hdi_country%>%
ggplot(aes(x=HDI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=percent_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Human Development Index (HDI) and R downloads.",
y="Downloads per country",
x="Human Development Index")
ggplotly(downloads_hdi_plot)
# Chunk 15: checking-correlation
cor(downloads_hdi_country$users,downloads_hdi_country$HDI)*100
# Chunk 16: fitting-hdi-users
internet_fit <- lm(n ~ users, data=downloads_hdi_country)
hdi_fit <- lm(n ~ users + HDI, data=downloads_hdi_country)
summary(hdi_fit)$coef
# Chunk 17: diagnostics-hdi-users
plot(hdi_fit)
# Chunk 18
summary(hdi_fit)$adj.r.squared*100
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
glimpse(standard_liv)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
glimpse(standard_liv)
glimpse(downloads_hdi_country)
downloads_hdi_country%>%glimpse()
downloads_hdi_country$`alpha-3`
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c("`alpha-3`"="iso"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))%>%
select(name, GNI)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
head(standard_liv)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
head(standard_liv)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))%>%
select(name, GNI)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))%>%
select(name, GNI)
glimpse(downloads_hdi_country)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
life_exp <- read_csv(here("static","data","life_exp.csv"))
glimpse(life_exp)
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(standard_liv, by=c(`country-code`="country_code"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
arrange(desc(GNI))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
arrange(desc(life_exp))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp))
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
life_exp <- read_csv(here("static","data","life_exp.csv"))
edu_year <- read_csv(here("static","data","edu_year.csv"))
glimpse(edu_year)
levels(edu_year$Indicator)
View(edu_year)
edu_year%>%
filter(Indicator=="Mean years of schooling (ISCED 1 or higher), population 25+ years, both sexes")
edu_year%>%
filter(Indicator=="Mean years of schooling (ISCED 1 or higher), population 25+ years, both sexes",
year==2016)
edu_year%>%
filter(Indicator=="Mean years of schooling (ISCED 1 or higher), population 25+ years, both sexes",
year==2016)%>%
select(country,edu)
edu_year%>%
filter(Indicator=="Mean years of schooling (ISCED 1 or higher), population 25+ years, both sexes",
year==2016)%>%
select(country,educ)
standard_liv <- read_csv(here("static","data","GNIPC.csv"))
standard_liv$GNI <- as.integer(standard_liv$GNI)
life_exp <- read_csv(here("static","data","life_exp.csv"))
edu_year <- read_csv(here("static","data","edu_year.csv"))
edu_year <- edu_year%>%
filter(Indicator=="Mean years of schooling (ISCED 1 or higher), population 25+ years, both sexes",
year==2016)%>%
select(country,educ)
glimpse(edu_year)
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
left_join(edu_year, by=c(`alpha-3`="country"))%>%
arrange(desc(educ))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp),
!is.na(educ))
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
left_join(edu_year, by=c(`alpha-3`="country"))%>%
arrange(desc(educ))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp),
!is.na(educ))%>%
select(name,educ)
#full_hdi <-
downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
left_join(edu_year, by=c(`alpha-3`="country"))%>%
arrange(desc(educ))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp),
!is.na(educ))
full_hdi <- downloads_hdi_country%>%
left_join(standard_liv, by=c(`alpha-3`="iso"))%>%
left_join(life_exp, by=c(`country-code`="country_code"))%>%
left_join(edu_year, by=c(`alpha-3`="country"))%>%
arrange(desc(educ))%>%
filter(!is.na(name),
!is.na(users),
!is.na(n),
!is.na(HDI),
!is.na(GNI),
!is.na(life_exp),
!is.na(educ))
life_exp_plot<- full_hdi%>%
ggplot(aes(x=life_exp, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Life expectancy at birth and R downloads.",
y="Downloads per country",
x="Life expectancy at birth (Years)")
ggplotly(life_exp_plot)
educ_plot<- full_hdi%>%
ggplot(aes(x=educ, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Mean years of schooling (years) and R downloads.",
y="Downloads per country",
x="Mean years of schooling (years)")
ggplotly(educ_plot)
GNI_plot<- full_hdi%>%
ggplot(aes(x=GNI, y=n, label=name, color=region))+
#Add light opacity
geom_jitter(alpha=0.3)+
#Add nice commas x axis
scale_x_continuous(labels=dollar_format())+
#Add nice commas y axis
scale_y_continuous(labels=comma_format())+
#Add a linear regression line for all regions
geom_smooth(aes(group=1),method="lm")+
#Fix legend
theme(legend.position = "bottom", legend.title = element_blank())+
#Add title
labs(title="Gross National Income and R downloads.",
y="Downloads per country",
x="Gross National Income")
ggplotly(GNI_plot)
four_fit <- lm(n ~ users + GNI + educ + life_exp, data=full_hdi)
summary(four_fit)$coef
full_hdi$GNI
four_fit <- lm(n ~ users + GNI + educ + life_exp, data=full_hdi)
summary(four_fit)$coef
summary(four_fit)
four_fit <- lm(n ~ users + GNI + educ , data=full_hdi)
summary(four_fit)$coef
summary(four_fit)
four_fit <- lm(n ~ users + GNI + educ + life_exp + HDI, data=full_hdi)
summary(four_fit)$coef
cor(four_fit)
cor(full_hdi$users,full_hdi$GNI)
four_fit <- lm(n ~ users + GNI + educ + life_exp + HDI, data=full_hdi)
summary(four_fit)$coef
cor(full_hdi$HDI,full_hdi$GNI)
cor(full_hdi$HDI,full_hdi$life_exp)
cor(full_hdi$HDI,full_hdi$educ)
four_fit <- lm(n ~ users + GNI + educ + life_exp, data=full_hdi)
summary(four_fit)$coef
blogdown::serve_site()
